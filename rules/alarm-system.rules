rule "SWITCH_ALARM_SYSTEM"
    when
    	Item SWITCH_ALARM_SYSTEM received command
    then
        if (receivedCommand == ON) {
            logInfo("alarm-system.rules", "Alarm armed")
            var HSBType flash = new HSBType(new DecimalType(120), new PercentType(100), new PercentType(100))
            CL_HUE_FL.sendCommand(flash)
            createTimer(now.plusSeconds(1)) [|
                var HSBType normal = new HSBType(new DecimalType(0), new PercentType(0), new PercentType(100))
                CL_HUE_FL.sendCommand(normal)
            ]
        } else {
            logInfo("alarm-system.rules", "Alarm disarmed")
            var HSBType currentState = CL_HUE_FL.state
            var HSBType flash = new HSBType(new DecimalType(0), new PercentType(100), new PercentType(100))
            CL_HUE_FL.sendCommand(flash)
            createTimer(now.plusSeconds(1)) [|
                var HSBType normal = new HSBType(new DecimalType(0), new PercentType(0), new PercentType(100))
                CL_HUE_FL.sendCommand(normal)
            ]
        }
end