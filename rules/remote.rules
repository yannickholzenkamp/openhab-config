import java.lang.String
var String remoteLastUpdate

rule "Hue Remote"
when
    Item Hue_Remote_Flur changed 
then
    logInfo("remote.rules", "Remote Input: " + Hue_Remote_Flur.state.toString)
    var String state = Hue_Remote_Flur.state.toString.split("-RMT-").get(0) 
    var String timestamp = Hue_Remote_Flur.state.toString.split("-RMT-").get(1)
    if ( timestamp != remoteLastUpdate ) {
        logInfo("remote.rules", "Remote: New Command " + state)
        sendBroadcastNotification("Remote: New Command " + state)
        switch state {
            case "1000": {
                logInfo("remote.rules", "Remote: On / Short - Case 1000")
                var HSBType command = new HSBType(new DecimalType(0), new PercentType(90), new PercentType(100))
                HUE_MODE_EZ.sendCommand(command)
                HUE_MODE_WZ.sendCommand(command)
        	}
            case "1002": {
                logInfo("remote.rules", "Remote: On / Short")
                var HSBType command = new HSBType(new DecimalType(0), new PercentType(90), new PercentType(100))
                HUE_MODE_EZ.sendCommand(command)
                HUE_MODE_WZ.sendCommand(command)
        	}
            case "1003": {
                logInfo("remote.rules", "Remote: On / Long")
                var HSBType command = new HSBType(new DecimalType(0), new PercentType(90), new PercentType(40))
                HUE_MODE_WZ.sendCommand(command)
                SW_SETTINGS_FERNSEHEN.sendCommand("ON")
        	}
			case "2002": {
                logInfo("remote.rules", "Remote: Dim up / Short")
            }
            case "2003": {
                logInfo("remote.rules", "Remote: Dim up / Long")
                SWITCH_ALARM_SYSTEM.sendCommand("OFF")
            }
			case "3002": {
                logInfo("remote.rules", "Remote: Dim down / Short")
                logInfo("remote.rules", "State SZ: " + HUE_MODE_SZ.state)
                if (HUE_MODE_SZ.state == ON) {
                    HUE_MODE_SZ.sendCommand("OFF")
                } else {
                    var HSBType command = new HSBType(new DecimalType(0), new PercentType(10), new PercentType(100))
                    HUE_MODE_SZ.sendCommand(command)
                }
            }
            case "3003": {
                logInfo("remote.rules", "Remote: Dim down / Long")
                var HSBType command = new HSBType(new DecimalType(0), new PercentType(100), new PercentType(20))
                HUE_MODE_SZ.sendCommand(command)
            }
            case "4000": {
                logInfo("remote.rules", "Remote: Off / Short - Case 4000")
                SW_SETTINGS_FERNSEHEN_LIGHTS.postUpdate("NO_LIGHT")
                SW_SETTINGS_FERNSEHEN.sendCommand("OFF")
				HUE_MODE_ALL.sendCommand("OFF")
        	}
			case "4002": {
                logInfo("remote.rules", "Remote: Off / Short")
                SW_SETTINGS_FERNSEHEN_LIGHTS.postUpdate("NO_LIGHT")
                SW_SETTINGS_FERNSEHEN.sendCommand("OFF")
				HUE_MODE_ALL.sendCommand("OFF")
        	}
            case "4003": {
                logInfo("remote.rules", "Remote: Off / Long")
                SW_SETTINGS_FERNSEHEN_LIGHTS.postUpdate("NO_LIGHT")
                SW_SETTINGS_FERNSEHEN.sendCommand("OFF")
				HUE_MODE_ALL.sendCommand("OFF")
                SWITCH_ALARM_SYSTEM.sendCommand("ON")
        	}
        }
        remoteLastUpdate = timestamp
    }
end